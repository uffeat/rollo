<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="shortcut icon" href="#" type="image/x-icon" />
    <title>Test</title>
    <script type="module">
      const __key__ = (
        await import("../secrets.json", { with: { type: "json" } })
      ).default.development.server;
      //console.log("__key__:", __key__);////

      const options = {
        headers: { "content-type": "text/plain; charset=utf-8" },
        method: "POST",
      };

      const submission = (() => {
        let submission = 0;
        return () => submission++;
      })();

      const response = await fetch(
        `https://rollohdev.anvil.app/_/api/echo?submission=${submission()}`,
        {
          body: JSON.stringify({
            __key__,
            data: { foo: 42 },
          }),
          ...options,
        }
      );

      //console.log("response:", response);////

      const result = await response.json();
     

     

      if ('__error__' in result) {
        console.error('meta:', result.meta)
        throw new Error(result.__error__)
        
      }

      console.log("result:", result);//
      
     


      
    </script>
  </head>
  <body></body>
</html>
