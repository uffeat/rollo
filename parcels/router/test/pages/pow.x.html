<style name="sheet">
  [path="/pages/pow.x.html"] {
    h1 {
      background-color: bisque;
      color: hotpink;
    }
  }
</style>

<script type="module">
  const { component } = await use("@/component.js");
  const { layout } = await use("@/layout/");
  const { ref, reactive } = await use("@/state.js");

  const page = component.main("container", component.h1({ text: "POW!" }));
  page.attribute.path = __path__;

  const state = ref({ name: "mode" });

  export default function () {
    this.assets.sheet.disabled = true;
    this.assets.sheet.use();

    state.effects.add(
      (mode) => {
        if (mode.enter) {
          this.assets.sheet.disabled = false;
          layout.clear(":not([slot])");
          layout.append(page);
        } else if (mode.exit) {
          page.remove();
          this.assets.sheet.disabled = true;
        }
      },
      { run: false }
    );

    return (mode, query, ...args) => {
      state(mode);
    };
  }
</script>
